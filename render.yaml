# Render Deployment Configuration
# This file defines the infrastructure for CreAI Platform on Render

services:
  # Web Service - Next.js Landing Page
  - type: web
    name: creai-web
    runtime: node
    region: oregon
    plan: starter # Free tier to start
    rootDir: apps/web
    buildCommand: npm install && npm run build
    startCommand: npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: NEXT_PUBLIC_APP_URL
        value: https://creai.onrender.com
      - key: DATABASE_URL
        sync: false # Set in Render dashboard
      - key: NEXTAUTH_SECRET
        generateValue: true # Render will auto-generate
      - key: NEXTAUTH_URL
        value: https://creai.onrender.com
      - key: OPENAI_API_KEY
        sync: false # Set in Render dashboard
      - key: STRIPE_SECRET_KEY
        sync: false # Set in Render dashboard
      - key: STRIPE_PUBLISHABLE_KEY
        sync: false # Set in Render dashboard
      - key: STRIPE_WEBHOOK_SECRET
        sync: false # Set in Render dashboard
    healthCheckPath: /
    autoDeploy: true

    # Custom domains (add after initial deployment)
    # domains:
    #   - www.creai.dev

  # PostgreSQL Database
  - type: pserv
    name: creai-db
    runtime: docker
    plan: starter # Free tier PostgreSQL
    region: oregon
    envVars:
      - key: POSTGRES_PASSWORD
        generateValue: true
      - key: POSTGRES_USER
        value: creai
      - key: POSTGRES_DB
        value: creai_production

  # Redis Cache (Optional - for later)
  # - type: pserv
  #   name: creai-redis
  #   runtime: docker
  #   plan: starter
  #   region: oregon
  #   dockerfilePath: ./docker/redis.Dockerfile
